/*!
 * Flowtime.js
 * http://marcolago.com/flowtime-js/
 * MIT licensed
 *
 * Copyright (C) 2012-2013 Marco Lago, http://marcolago.com
 */var Flowtime=function(){function W(e){var t=e.target.getAttribute("href");if(t&&t.substr(0,1)=="#"){e.target.blur();e.preventDefault();var n=t,r=z.setPage(n);mt(r,!0,!0)}if(T){var r=e.target;while(r&&!Brav1Toolbox.hasClass(r,i))r=r.parentNode;if(Brav1Toolbox.hasClass(r,i)){e.preventDefault();mt(r,null,!0)}}if(Brav1Toolbox.hasClass(e.target,v)){e.preventDefault();var s=Number(vt(e.target.getAttribute("data-section"))),o=Number(vt(e.target.getAttribute("data-page")));Ft(s,o)}}function X(e){E=!1;var t;e.state?t=e.state.token.replace("#/",""):t=document.location.hash.replace("#/","");var n=z.setPage(t);mt(n,!1)}function V(e,t){if(E||t){var n=document.location.hash.replace("#/",""),r=z.setPage(n);mt(r,!1)}}function nt(e){e.preventDefault();e=st(e);K=e.clientX;Q=e.clientY;Z=1;var t=ot();$=t.x;J=t.y}function rt(e){e.preventDefault();e=st(e);G=e.clientX-K;Y=e.clientY-Q}function it(e){e=st(e);Z=0;et=Math.abs(G)>=Math.abs(Y)?"x":"y";et=="x"&&Math.abs(G)>=tt?G>0?Ht():G<0?Pt():mt():Y>0&&Math.abs(Y)>=tt?jt():Y<0?Bt():mt()}function st(e){e.touches&&(e=e.touches[0]);return e}function ot(){var e=y.style[Brav1Toolbox.getPrefixed("transform")],t=e.indexOf("translateX(")+11,n=e.substring(t,e.indexOf(")",t));if(n.indexOf("%")!=-1){n=n.replace("%","");n=parseInt(n)/100*window.innerWidth}else n.indexOf("px")!=-1&&(n=parseInt(n.replace("px","")));var r=e.indexOf("translateY(")+11,i=e.substring(r,e.indexOf(")",r));if(i.indexOf("%")!=-1){i=i.replace("%","");i=parseInt(i)/100*window.innerHeight}else i.indexOf("px")!=-1&&(i=parseInt(i.replace("px","")));return{x:n,y:i}}function at(t){t.preventDefault();wt();if(e=="tapioca")if(ut==1){var n={x:window.pageXOffset,y:window.pageYOffset},r,i,s=z.getAllPages();for(var o=0;o<s.length;o++){var u={x:s[o].x,y:s[o].y};if(o==0){r=s[o];i=Brav1Toolbox.distance(n,u)}else if(Brav1Toolbox.distance(n,u)<i){r=s[o];i=Brav1Toolbox.distance(n,u)}}ut=!1;window.scrollTo(r.x,r.y)}else ut=!0}function lt(e){if(e.length>0){var t=e.replace("#/","").split("/"),n=document.querySelector(r+"[data-id=__"+t[0]+"]")||document.querySelector(r+"[data-prog=__"+t[0]+"]");if(n!=null){var i=null;t.length>1&&(i=n.querySelector(s+"[data-id=__"+t[1]+"]")||n.querySelector(s+"[data-prog=__"+t[1]+"]"));i==null&&(i=n.querySelector(s));return i}}return}function ct(){z.update();V(null,!0)}function ht(e){var t=N,n=z.getCurrentPage().getAttribute("data-title");if(n==null){var r=e.split("/");for(var i=0;i<r.length;i++)t+=" | "+r[i]}else{z.getCurrentSection().getAttribute("data-title")!=null&&(t+=" | "+z.getCurrentSection().getAttribute("data-title"));t+=" | "+n}document.title=t}function pt(e){return e.getAttribute("data-id")!=null?e.getAttribute("data-id").replace(/__/,""):e.getAttribute("data-prog").replace(/__/,"")}function dt(e){return e.substr(0,2)!="__"?"__"+e:e}function vt(e){return e.substr(0,2)=="__"?e.replace(/__/,""):e}function mt(e,n,r){n=n==0?n:!0;if(!e){z.getCurrentPage()!=null?e=z.getCurrentPage():e=document.querySelector(s);n=!0}yt(e);bt(e);T&&Ct(!1,!1);var i=z.getHash(e);r==1&&z.updateFragments();var o=z.getPageIndex(e);if(x.section!=o.section||x.page!=o.page)if(t!=null&&n!=0&&z.getCurrentFragmentIndex()==-1){var u={token:i},a="#/"+i;S=a;window.history.pushState(u,null,S)}else document.location.hash="/"+i;ht(i);gt();x=o;z.switchActivePage(e,!0);H&&Tt()}function gt(){var e=z.getPageIndex();Brav1Toolbox.dispatchEvent(g,{section:z.getCurrentSection(),page:z.getCurrentPage(),sectionIndex:e.section,pageIndex:e.page,pastSectionIndex:x.section,pastPageIndex:x.page,prevSection:z.hasPrevSection(),nextSection:z.hasNextSection(),prevPage:z.hasPrevPage(),nextPage:z.hasNextPage(),fragment:z.getCurrentFragment(),fragmentIndex:z.getCurrentFragmentIndex(),isOverview:T,progress:z.getProgress(),total:z.getPagesTotalLength()})}function yt(e){var t,n,r=z.getPageIndex(e);if(M==1){t=e.x;n=e.y}else{t=r.section;n=r.page}if(Brav1Toolbox.testCSS("transform"))M?y.style[Brav1Toolbox.getPrefixed("transform")]="translateX("+ -t+"px) translateY("+ -n+"px)":y.style[Brav1Toolbox.getPrefixed("transform")]="translateX("+ -t*100+"%) translateY("+ -n*100+"%)";else if(M){y.style.top=-n+"px";y.style.left=-t+"px"}else{y.style.top=-n*100+"%";y.style.left=-t*100+"%"}wt()}function bt(e){if(I){var t=z.getPageIndex(e),n=z.getParallaxElements();for(var r=0;r<n.length;r++){var i=n[r];if(i!=undefined)for(var s=0;s<i.length;s++){var o=i[s];if(o!=undefined)for(var u=0;u<o.length;u++){var a=o[u],f=0,l=0;t.section<r?f=a.pX:t.section>r&&(f=-a.pX);t.page<s?l=a.pY:t.page>s&&(l=-a.pY);B?a.style[Brav1Toolbox.getPrefixed("transform")]="translateX("+f+"px) translateY("+l+"px)":a.style[Brav1Toolbox.getPrefixed("transform")]="translateX("+f+"%) translateY("+l+"%)"}}}}}function wt(){window.scrollTo(0,0)}function St(){var e=document.createDocumentFragment();L=document.createElement("div");L.className=c;e.appendChild(L);for(var t=0;t<z.getSectionsLength();t++){var n=document.createElement("div");n.setAttribute("data-section","__"+t);n.className=p;Brav1Toolbox.addClass(n,"thumb-section-"+t);var r=z.getPages(t);for(var i=0;i<r.length;i++){var s=document.createElement("div");s.className=v;s.setAttribute("data-section","__"+t);s.setAttribute("data-page","__"+i);Brav1Toolbox.addClass(s,"thumb-page-"+i);n.appendChild(s)}L.appendChild(n)}w.appendChild(L)}function xt(){if(L!=null){w.removeChild(L);L=null}}function Tt(){if(L!=null){var e=L.querySelectorAll(m);for(var t=0;t<e.length;t++){var n=e[t],r=Number(vt(n.getAttribute("data-section"))),i=Number(vt(n.getAttribute("data-page")));r==z.getPageIndex().section&&i==z.getPageIndex().page?Brav1Toolbox.addClass(e[t],"actual"):Brav1Toolbox.removeClass(e[t],"actual")}}}function Nt(){return L}function Ct(e,t){if(T)kt(e,t);else{C=z.getCurrentPage();Lt()}}function kt(e,t){T=!1;Brav1Toolbox.removeClass(w,"ft-overview");z.hideFragments();t=t===!1?!1:!0;t==1&&(e==1?mt(C):mt())}function Lt(){T=!0;Brav1Toolbox.addClass(w,"ft-overview");z.showFragments();D==0?At(!0):Ot(!0);gt()}function At(e){if(e){var t=100/z.getSectionsLength(),n=100/z.getPagesLength(),r=Math.min(t,n)*.9,i=(100-z.getSectionsLength()*r)/2,s=(100-z.getPagesLength()*r)/2;y.style[Brav1Toolbox.getPrefixed("transform")]="translate("+i+"%, "+s+"%) scale("+r/100+", "+r/100+")"}}function Ot(e){if(e){var t=k,n=z.getPageIndex(),r=50-t*n.section-t/2,i=50-t*n.page-t/2;y.style[Brav1Toolbox.getPrefixed("transform")]="translate("+r+"%, "+i+"%) scale("+t/100+", "+t/100+")"}}function Mt(e){var t=e.target.tagName;t!="INPUT"&&t!="TEXTAREA"&&t!="SELECT"&&e.keyCode>=37&&e.keyCode<=40&&e.preventDefault()}function _t(e){var t=e.target.tagName,n;if(t!="INPUT"&&t!="TEXTAREA"&&t!="SELECT"){e.preventDefault();switch(e.keyCode){case 27:Ct(!0);break;case 33:Rt();break;case 34:Ut();break;case 35:qt();break;case 36:It();break;case 37:Ht(e.shiftKey);break;case 39:Pt(e.shiftKey);break;case 38:jt(e.shiftKey);break;case 40:Bt(e.shiftKey);break;case 13:T&&Ft(z.getCurrentHilited());break;default:}}}function Dt(){H&&L==null&&St();if(document.location.hash.length>0){Brav1Toolbox.addClass(y,"no-transition");V(null,!0);Brav1Toolbox.removeClass(y,"no-transition")}else if(Dt.arguments.length>0)Ft.apply(this,Dt.arguments);else{Ft(0,0);Tt()}}function Pt(e){var t=z.getNextSection(e,A,T);t!=undefined?mt(t):T&&D&&Lt()}function Ht(e){var t=z.getPrevSection(e,A,T);t!=undefined?mt(t):T&&D&&Lt()}function Bt(e){var t=z.getNextPage(e,T);t!=undefined?mt(t):T&&D&&Lt()}function jt(e){var t=z.getPrevPage(e,T);t!=undefined?mt(t):T&&D&&Lt()}function Ft(){var e=Ft.arguments;if(e.length>0){if(e.length==1)if(Brav1Toolbox.typeOf(e[0])==="Object"){var t=e[0],n=t.section,i=t.page;if(n!=null&&n!=undefined){var o=document.querySelector(r+"[data-id="+dt(n)+"]");if(i!=null&&i!=undefined){var u=o.querySelector(s+"[data-id="+dt(i)+"]");if(u!=null){mt(u);return}}}}else e[0].nodeName!=undefined&&mt(e[0],null,!0);if(Brav1Toolbox.typeOf(e[0])==="Number"||e[0]===0){var u=z.getPageByIndex(e[1],e[0]);mt(u);return}}}function It(){Ft(0,0)}function qt(){var e=z.getSectionsLength()-1;Ft(e,z.getPages(e).length-1)}function Rt(){var e=z.getPageIndex();Ft(e.section,0)}function Ut(){var e=z.getPageIndex();Ft(e.section,z.getPages(e.section).length-1)}function zt(e,t,n){Brav1Toolbox.addListener(document,e,t,n)}function Wt(e){A=e;Xt(e)}function Xt(e){O=e}function Vt(e){t=e}function $t(e){M=e;mt()}function Jt(e){_=e}function Kt(e){_=!e}function Qt(e){D=e}function Gt(e){P=e}function Yt(e){H=e;if(H){L==null&&St();Tt()}else L!=null&&xt()}function Zt(e,t){j=e;F=t==undefined?j:t;z.update()}function en(e){B=e}var e="ontouchstart"in document.documentElement,t=window.history.pushState,n="ft-section",r="."+n,i="ft-page",s="."+i,o="ft-fragment",u="."+o,a="revealed",f="actual",l="revealed-temp",c="ft-default-progress",h="."+c,p="ft-section-thumb",d="."+p,v="ft-page-thumb",m="."+v,g="flowtimenavigation",y=document.querySelector(".flowtime"),b=document.querySelector("html"),w=document.querySelector("body"),E=!1,S="",x={section:0,page:0},T=!1,N=document.title,C,k=22,L=null,A=!1,O=!0,M=!1,_=!1,D=!1,P=!1,H=!1,B=!1,j=50,F=50,I=document.querySelector(".parallax")!=null,q=!0;try{var R=document.querySelector("html").className.toLowerCase();if(R.indexOf("ie7")!=-1||R.indexOf("ie8")!=-1||R.indexOf("lt-ie9")!=-1)q=!1}catch(U){q=!1}q&&Brav1Toolbox.addClass(w,"ft-absolute-nav");var z=function(){function S(){t=[];h=[];i=document.querySelectorAll(u);o=[];e=y.querySelectorAll(".flowtime > "+r);n=y.querySelectorAll(".flowtime "+s);for(var a=0;a<e.length;a++){var f=[],l=e[a];o[a]=[];c[a]=[];l.getAttribute("data-id")&&l.setAttribute("data-id","__"+vt(l.getAttribute("data-id")));l.setAttribute("data-prog","__"+(a+1));l.index=a;l.setAttribute("id","");pages=l.querySelectorAll(s);v+=pages.length;d=Math.max(d,pages.length);for(var m=0;m<pages.length;m++){var g=pages[m];g.getAttribute("data-id")&&g.setAttribute("data-id","__"+vt(g.getAttribute("data-id")));g.setAttribute("data-prog","__"+(m+1));g.index=m;g.setAttribute("id","");if(!g.getAttribute("data-title")){var b=g.querySelector("h1");b!=null&&b.textContent.lenght!=""&&g.setAttribute("data-title",b.textContent)}N(g,a,m);f.push(g);var w=g.querySelectorAll(u);o[a][m]=w;c[a][m]=-1}t.push(f)}p=e.length;wt();k()}function N(e,t,n){if(I){h[t]==undefined&&(h[t]=[]);h[t][n]==undefined&&(h[t][n]=[]);var r=e.querySelectorAll(".parallax");if(r.length>0)for(var i=0;i<r.length;i++){var s=r[i],o=j,u=F;if(s.getAttribute("data-parallax")!=null){var a=s.getAttribute("data-parallax").split(",");o=u=a[0];a.length>1&&(u=a[1])}s.pX=o;s.pY=u;h[t][n].push(s)}}}function C(){return h}function k(){for(var e=0;e<n.length;e++){var t=n[e];t.x=t.offsetLeft+t.parentNode.offsetLeft;t.y=t.offsetTop+t.parentNode.offsetTop}}function L(e,n,r){var i=g,s=e==!_;if(n==1&&o[m][g].length>0&&c[m][g]<o[m][g].length-1&&s!=1&&r==0){B(m,g);return H(t[m][g],r)}i=0;if(s==1&&m+1<t.length-1)i=0;else if(s!=1||O==1||m+1>t.length-1)i=g;m=Math.min(m+1,t.length-1);return M(t[m],i,r)}function A(e,n,r){var i=g,s=e==!_;if(n==1&&o[m][g].length>0&&c[m][g]>=0&&s!=1&&r==0){q(m,g);return H(t[m][g],r)}var i=0;i=0;if(s==1&&m-1>=0)i=0;else if(s!=1||O==1||m-1<0)i=g;m=Math.max(m-1,0);return M(t[m],i,r)}function M(e,t,n){var r=e[t];if(r==undefined)for(var i=t;i>=0;i--)if(e[i]!=undefined){r=e[i];t=i;break}g=t;T||W();return H(r,n)}function D(e,n){if(o[m][g].length>0&&c[m][g]<o[m][g].length-1&&e!=1&&n==0)B(m,g);else if(t[m][g+1]==undefined&&t[m+1]!=undefined){m+=1;g=0}else g=Math.min(g+1,t[m].length-1);return H(t[m][g],n)}function P(e,n){if(o[m][g].length>0&&c[m][g]>=0&&e!=1&&n==0)q(m,g);else if(g==0&&t[m-1]!=undefined){m-=1;g=t[m].length-1}else g=Math.max(g-1,0);return H(t[m][g],n)}function H(e,t){if(t==1){mt(e);return}return e}function B(e,t,n){n!=undefined?c[e][t]=n:n=c[e][t]+=1;for(var r=0;r<=n;r++){Brav1Toolbox.addClass(o[e][t][r],a);Brav1Toolbox.removeClass(o[e][t][r],f)}Brav1Toolbox.addClass(o[e][t][n],f)}function q(e,t,n){n!=undefined?c[e][t]=n:n=c[e][t];for(var r=0;r<o[e][t].length;r++){if(r>=n){Brav1Toolbox.removeClass(o[e][t][r],a);Brav1Toolbox.removeClass(o[e][t][r],l)}Brav1Toolbox.removeClass(o[e][t][r],f)}n-=1;n>=0&&Brav1Toolbox.addClass(o[e][t][n],f);c[e][t]=n}function R(){for(var e=0;e<i.length;e++)Brav1Toolbox.addClass(i[e],l)}function U(){for(var e=0;e<i.length;e++)Brav1Toolbox.removeClass(i[e],l)}function W(){for(var e=0;e<o.length;e++){var t=o[e];for(var n=0;n<t.length;n++){var r=t[n];if(r.length>0)if(e>m)for(var i=r.length-1;i>=0;i--)q(e,n,i);else if(e<m)for(var i=0;i<r.length;i++)B(e,n,i);else if(e==m)if(n>g)for(var i=r.length-1;i>=0;i--)q(e,n,i);else if(n<g)for(var i=0;i<r.length;i++)B(e,n,i);else if(n==g){if(O==1&&(x.section>z.getPageIndex().section||x.page>z.getPageIndex().page))for(var i=0;i<r.length;i++)B(e,n,i);else for(var i=r.length-1;i>=0;i--)q(e,n,i);O==0?c[e][n]=-1:x.section>z.getPageIndex().section||x.page>z.getPageIndex().page?c[e][n]=r.length-1:c[e][n]=-1}}}}function X(e){e;return m}function V(e){e;return g}function $(){return e}function J(e){return t[e]}function K(){return n}function Q(){return p}function G(){return d}function Y(){return v}function Z(e){var t=m,n=g;if(e!=undefined){t=e.parentNode.index;n=e.index}return{section:t,page:n}}function et(t){return e[t]}function tt(e,n){return t[n][e]}function nt(){return e[m]}function rt(){return t[m][g]}function it(){return o[m][g][st()]}function st(){return c[m][g]}function ot(){return m<e.length-1}function ut(){return m>0}function at(){return g<t[m].length-1}function ft(){return g>0}function ct(){if(m==0&&g==0)return 0;var e=0;for(var n=0;n<m;n++)e+=t[n].length;e+=t[m][g].index+1;return e}function ht(n){if(n!=undefined){g=Z(n).page;m=Z(n).section}var r="",i=e[m];r+=pt(i);if(t[m].length>1){var s=t[m][g];r+="/"+pt(s)}return r}function dt(n){var r=lt(n);if(r){var i=r.parentNode;for(var s=0;s<t.length;s++){var o=t[s];if(e[s]===i){m=s;for(var u=0;u<o.length;u++)if(o[u]===r){g=u;break}}}W()}return r}function mt(e,n){var r=e.parentNode.index;for(var i=0;i<t.length;i++){var s=t[i];for(var o=0;o<s.length;o++){var u=s[o];Brav1Toolbox.removeClass(u,"past-section");Brav1Toolbox.removeClass(u,"future-section");Brav1Toolbox.removeClass(u,"past-page");Brav1Toolbox.removeClass(u,"future-page");if(u!==e){Brav1Toolbox.removeClass(u,"hilite");T==0&&u!==rt()&&Brav1Toolbox.removeClass(u,"actual");i<r?Brav1Toolbox.addClass(u,"past-section"):i>r&&Brav1Toolbox.addClass(u,"future-section");u.index<e.index?Brav1Toolbox.addClass(u,"past-page"):u.index>e.index&&Brav1Toolbox.addClass(u,"future-page")}}}Brav1Toolbox.addClass(e,"hilite");n&&yt(e);E=e}function gt(){return E}function yt(e){Brav1Toolbox.addClass(e,"actual")}var e,t,n,i,o,c=[],h=[],p=0,d=0,v=0,m=0,g=0,b=0,w=0,E;S();return{update:S,updateFragments:W,showFragments:R,hideFragments:U,getSection:X,getPage:V,getSections:$,getPages:J,getAllPages:K,getNextSection:L,getPrevSection:A,getNextPage:D,getPrevPage:P,getSectionsLength:Q,getPagesLength:G,getPagesTotalLength:Y,getPageIndex:Z,getSectionByIndex:et,getPageByIndex:tt,getCurrentSection:nt,getCurrentPage:rt,getCurrentFragment:it,getCurrentFragmentIndex:st,getProgress:ct,getHash:ht,setPage:dt,switchActivePage:mt,getCurrentHilited:gt,hasNextSection:ot,hasPrevSection:ut,hasNextPage:at,hasPrevPage:ft,updateOffsets:k,getParallaxElements:C}}();if(q){Brav1Toolbox.addListener(document,"click",W,!1);Brav1Toolbox.addListener(document,"touchend",W,!1)}E==0&&window.history.pushState?window.onpopstate=X:E=!0;Brav1Toolbox.addListener(window,"hashchange",V);var $=y.offsetX,J=0,K=0,Q=0,G=0,Y=0,Z=0,et="x",tt=100;b.addEventListener("touchstart",nt,!1);b.addEventListener("touchmove",rt,!1);b.addEventListener("touchend",it,!1);var ut=!0;Brav1Toolbox.addListener(window,"scroll",at);var ft=function(){function n(){r();T||(t=setTimeout(i,300))}function r(){clearTimeout(t)}function i(){z.updateOffsets();mt()}var t=NaN;Brav1Toolbox.addListener(window,"resize",n);window.addEventListener("orientationchange",n,!1);return{enable:n,disable:r}}(),L=null,Et=null;Brav1Toolbox.addListener(window,"keydown",Mt);Brav1Toolbox.addListener(window,"keyup",_t);return{start:Dt,updateNavigation:ct,nextSection:Pt,prevSection:Ht,next:Bt,prev:jt,nextFragment:Bt,prevFragment:jt,gotoPage:Ft,gotoHome:It,gotoTop:Rt,gotoBottom:Ut,gotoEnd:qt,toggleOverview:Ct,fragmentsOnSide:Wt,fragmentsOnBack:Xt,useHistory:Vt,slideInPx:$t,sectionsSlideToTop:Jt,gridNavigation:Kt,useOverviewVariant:Qt,twoStepsSlide:Gt,showProgress:Yt,addEventListener:zt,defaultParallaxValues:Zt,parallaxInPx:en,getDefaultProgress:Nt}}();