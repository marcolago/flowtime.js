/*!
 * Brav1Toolbox.js - common utility scripts and polyfills
 * http://marcolago.com/
 * MIT licensed
 *
 * Copyright (C) 2012-now Marco Lago, http://marcolago.com
 */
var Brav1Toolbox=function(){var cssPrefixes=["","-webkit-","-moz-","-ms-","-o-"];function _getStyleObject(){if(window.getComputedStyle){return window.getComputedStyle(document.body)}else{return document.documentElement.style}}var styleObject=_getStyleObject();function _addListener(element,type,handler,useCapture){if(element.addEventListener){element.addEventListener(type,handler,useCapture)}else if(element.attachEvent){element.attachEvent("on"+type,handler)}}function _removeListener(element,type,handler){if(element.removeEventListener){element.removeEventListener(type,handler)}else if(element.detachEvent){element.detachEvent("on"+type,handler)}}function _testCSS(prop){return _getPrefixed(prop)!=""}function _getPrefixed(prop){var o=styleObject||_getStyleObject();for(var i=0;i<cssPrefixes.length;i++){var pre=cssPrefixes[i].replace(/-/g,"");var p=prop;if(pre.length>0){p=p.charAt(0).toUpperCase()+p.substr(1)}p=pre+p;if(p in o==true){return p}}return""}function _typeOf(obj){return!!obj&&Object.prototype.toString.call(obj).match(/(\w+)\]/)[1]}function _addClass(el,c){if(el.classList){el.classList.add(c)}else{if(_hasClass(el,c)==false){var cl=el.className;if(cl.length>0){cl+=" "}el.className=cl+c}}}function _removeClass(el,c){if(el.classList){el.classList.remove(c)}else{var cl=el.className;if(cl.indexOf(c)!=-1){if(cl.indexOf(" "+c)!=-1){cl=cl.replace(" "+c,"")}else if(cl.indexOf(c+" ")!=-1){cl=cl.replace(c+" ","")}else{cl=cl.replace(c,"")}}el.className=cl}}function _hasClass(el,c){if(el){if(el.classList){return el.classList.contains(c)}else if(el.className){return el.className.indexOf(c)!=-1}}return false}function _dispatchEvent(t,ps){if(document.createEvent){var e=document.createEvent("HTMLEvents");e.initEvent(t,true,true);for(var p in ps){e[p]=ps[p]}document.dispatchEvent(e)}}function _distance(pA,pB){var cX;var cY;cX=pB.x-pA.x;cX*=cX;cY=pB.y-pA.y;cY*=cY;return Math.abs(Math.sqrt(cX+cY))}return{addListener:_addListener,removeListener:_removeListener,dispatchEvent:_dispatchEvent,testCSS:_testCSS,getPrefixed:_getPrefixed,typeOf:_typeOf,addClass:_addClass,removeClass:_removeClass,hasClass:_hasClass,distance:_distance}}();/*!
 * Flowtime.js
 * http://marcolago.com/flowtime-js/
 * MIT licensed
 *
 * Copyright (C) 2012-now Marco Lago, http://marcolago.com
 */
var Flowtime=function(){var isTouchDevice=false;if("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0){isTouchDevice=true}var pushHistory=window.history.pushState;var SECTION_CLASS="ft-section";var SECTION_SELECTOR="."+SECTION_CLASS;var PAGE_CLASS="ft-page";var PAGE_SELECTOR="."+PAGE_CLASS;var FRAGMENT_CLASS="ft-fragment";var FRAGMENT_SELECTOR="."+FRAGMENT_CLASS;var FRAGMENT_REVEALED_CLASS="revealed";var FRAGMENT_ACTUAL_CLASS="actual";var FRAGMENT_REVEALED_TEMP_CLASS="revealed-temp";var DEFAULT_PROGRESS_CLASS="ft-default-progress";var DEFAULT_PROGRESS_SELECTOR="."+DEFAULT_PROGRESS_CLASS;var SECTION_THUMB_CLASS="ft-section-thumb";var SECTION_THUMB_SELECTOR="."+SECTION_THUMB_CLASS;var PAGE_THUMB_CLASS="ft-page-thumb";var PAGE_THUMB_SELECTOR="."+PAGE_THUMB_CLASS;var CROSS_DIRECTION_CLASS="ft-cross";var NAVIGATION_EVENT="flowtimenavigation";var ftContainer=document.querySelector(".flowtime");var html=document.querySelector("html");var body=document.querySelector("body");var useHash=false;var currentHash="";var pastIndex={section:0,page:0};var isOverview=false;var siteName=document.title;var overviewCachedDest;var overviewFixedScaleFactor=22;var defaultProgress=null;var _fragmentsOnSide=false;var _fragmentsOnBack=true;var _slideInPx=false;var _sectionsSlideToTop=false;var _useOverviewVariant=false;var _twoStepsSlide=false;var _isLoopable=false;var _showProgress=false;var _clickerMode=false;var _parallaxInPx=false;var defaultParallaxX=50;var defaultParallaxY=50;var parallaxEnabled=document.querySelector(".parallax")!=null;var _mouseDragEnabled=false;var _isScrollActive=true;var _isKeyboardActive=true;var _isTouchActive=true;var _areLinksActive=true;var _debouncingDelay=100;var _crossDirection=Brav1Toolbox.hasClass(ftContainer,CROSS_DIRECTION_CLASS);var _navigationCallback=undefined;var browserSupport=true;try{var htmlClass=document.querySelector("html").className.toLowerCase();if(htmlClass.indexOf("ie7")!=-1||htmlClass.indexOf("ie8")!=-1||htmlClass.indexOf("lt-ie9")!=-1){browserSupport=false}}catch(e){browserSupport=false}if(browserSupport){Brav1Toolbox.addClass(body,"ft-absolute-nav")}var NavigationMatrix=function(){var sections;var sectionsArray;var allPages;var fragments;var fragmentsArray;var fr=[];var parallaxElements=[];var sectionsLength=0;var pagesLength=0;var pagesTotalLength=0;var p=0;var sp=0;var pCache=0;var spCache=0;var hilited;function _updateMatrix(){sectionsArray=[];parallaxElements=[];fragments=document.querySelectorAll(FRAGMENT_SELECTOR);fragmentsArray=[];sections=ftContainer.querySelectorAll(".flowtime > "+SECTION_SELECTOR);allPages=ftContainer.querySelectorAll(".flowtime "+PAGE_SELECTOR);for(var i=0;i<sections.length;i++){var pagesArray=[];var section=sections[i];fragmentsArray[i]=[];fr[i]=[];if(section.getAttribute("data-id")){section.setAttribute("data-id","__"+unsafeAttr(section.getAttribute("data-id")))}section.setAttribute("data-prog","__"+(i+1));section.index=i;section.setAttribute("id","");pages=section.querySelectorAll(PAGE_SELECTOR);pagesTotalLength+=pages.length;pagesLength=Math.max(pagesLength,pages.length);for(var ii=0;ii<pages.length;ii++){var _sp=pages[ii];if(_sp.getAttribute("data-id")){_sp.setAttribute("data-id","__"+unsafeAttr(_sp.getAttribute("data-id")))}_sp.setAttribute("data-prog","__"+(ii+1));_sp.index=ii;_sp.setAttribute("id","");if(!_sp.getAttribute("data-title")){var heading=_sp.querySelector("h1");if(heading!=null&&heading.textContent.lenght!=""){_sp.setAttribute("data-title",heading.textContent)}}setParallax(_sp,i,ii);pagesArray.push(_sp);var subFragments=_sp.querySelectorAll(FRAGMENT_SELECTOR);fragmentsArray[i][ii]=subFragments;fr[i][ii]=-1}sectionsArray.push(pagesArray)}sectionsLength=sections.length;resetScroll();_updateOffsets()}function setParallax(page,sectionIndex,pageIndex){if(parallaxEnabled){if(parallaxElements[sectionIndex]==undefined){parallaxElements[sectionIndex]=[]}if(parallaxElements[sectionIndex][pageIndex]==undefined){parallaxElements[sectionIndex][pageIndex]=[]}var pxs=page.querySelectorAll(".parallax");if(pxs.length>0){for(var i=0;i<pxs.length;i++){var el=pxs[i];var pX=defaultParallaxX;var pY=defaultParallaxY;if(el.getAttribute("data-parallax")!=null){var pValues=el.getAttribute("data-parallax").split(",");pX=pY=pValues[0];if(pValues.length>1){pY=pValues[1]}}el.pX=pX;el.pY=pY;parallaxElements[sectionIndex][pageIndex].push(el)}}}}function _getParallaxElements(){return parallaxElements}function _updateOffsets(){for(var i=0;i<allPages.length;i++){var _sp=allPages[i];_sp.x=_sp.offsetLeft+_sp.parentNode.offsetLeft;_sp.y=_sp.offsetTop+_sp.parentNode.offsetTop}}function _getNextSection(top,fos){var sub=sp;var toTop=top==!_sectionsSlideToTop;if(fos==true&&fragmentsArray[p][sp].length>0&&fr[p][sp]<fragmentsArray[p][sp].length-1&&toTop!=true&&io==false){_showFragment(p,sp)}else{sub=0;if(toTop==true&&p+1<sectionsArray.length-1){sub=0}else if(toTop!=true||_fragmentsOnBack==true||p+1>sectionsArray.length-1){sub=sp}var pTemp=Math.min(p+1,sectionsArray.length-1);if(_isLoopable==true&&pTemp===p){p=0}else{p=pTemp}return _getNearestPage(sectionsArray[p],sub)}return hiliteOrNavigate(sectionsArray[p][sp])}function _getPrevSection(top,fos){var sub=sp;var toTop=top==!_sectionsSlideToTop;if(fos==true&&fragmentsArray[p][sp].length>0&&fr[p][sp]>=0&&toTop!=true&&isOverview==false){_hideFragment(p,sp)}else{var sub=0;sub=0;if(toTop==true&&p-1>=0){sub=0}else if(toTop!=true||_fragmentsOnBack==true||p-1<0){sub=sp}var pTemp=Math.max(p-1,0);if(_isLoopable==true&&pTemp===p){p=sectionsArray.length-1}else{p=pTemp}return _getNearestPage(sectionsArray[p],sub)}return hiliteOrNavigate(sectionsArray[p][sp])}function _getNearestPage(pg,sub){var nsp=pg[sub];if(nsp==undefined){for(var i=sub;i>=0;i--){if(pg[i]!=undefined){nsp=pg[i];sub=i;break}}}sp=sub;if(!isOverview){_updateFragments()}return hiliteOrNavigate(nsp)}function _getNextPage(jump){if(fragmentsArray[p][sp].length>0&&fr[p][sp]<fragmentsArray[p][sp].length-1&&jump!=true&&isOverview==false){_showFragment(p,sp)}else{if(sectionsArray[p][sp+1]==undefined){if(sectionsArray[p+1]!=undefined){p+=1;sp=0}else if(sectionsArray[p+1]==undefined&&_isLoopable==true){p=0;sp=0}}else{sp=Math.min(sp+1,sectionsArray[p].length-1)}}return hiliteOrNavigate(sectionsArray[p][sp])}function _getPrevPage(jump){if(fragmentsArray[p][sp].length>0&&fr[p][sp]>=0&&jump!=true&&isOverview==false){_hideFragment(p,sp)}else{if(sp==0){if(sectionsArray[p-1]!=undefined){p-=1;sp=sectionsArray[p].length-1}else if(sectionsArray[p-1]==undefined&&_isLoopable==true){p=sectionsArray.length-1;sp=sectionsArray[p].length-1}}else{sp=Math.max(sp-1,0)}}return hiliteOrNavigate(sectionsArray[p][sp])}function hiliteOrNavigate(d){if(isOverview==true){_switchActivePage(d);return}else{return d}}function _showFragment(fp,fsp,f){if(f!=undefined){fr[fp][fsp]=f}else{f=fr[fp][fsp]+=1}for(var i=0;i<=f;i++){Brav1Toolbox.addClass(fragmentsArray[fp][fsp][i],FRAGMENT_REVEALED_CLASS);Brav1Toolbox.removeClass(fragmentsArray[fp][fsp][i],FRAGMENT_ACTUAL_CLASS)}Brav1Toolbox.addClass(fragmentsArray[fp][fsp][f],FRAGMENT_ACTUAL_CLASS)}function _hideFragment(fp,fsp,f){if(f!=undefined){fr[fp][fsp]=f}else{f=fr[fp][fsp]}for(var i=0;i<fragmentsArray[fp][fsp].length;i++){if(i>=f){Brav1Toolbox.removeClass(fragmentsArray[fp][fsp][i],FRAGMENT_REVEALED_CLASS);Brav1Toolbox.removeClass(fragmentsArray[fp][fsp][i],FRAGMENT_REVEALED_TEMP_CLASS)}Brav1Toolbox.removeClass(fragmentsArray[fp][fsp][i],FRAGMENT_ACTUAL_CLASS)}f-=1;if(f>=0){Brav1Toolbox.addClass(fragmentsArray[fp][fsp][f],FRAGMENT_ACTUAL_CLASS)}fr[fp][fsp]=f}function _showFragments(){for(var i=0;i<fragments.length;i++){Brav1Toolbox.addClass(fragments[i],FRAGMENT_REVEALED_TEMP_CLASS)}}function _hideFragments(){for(var i=0;i<fragments.length;i++){Brav1Toolbox.removeClass(fragments[i],FRAGMENT_REVEALED_TEMP_CLASS)}}function _updateFragments(){for(var ip=0;ip<fragmentsArray.length;ip++){var frp=fragmentsArray[ip];for(var isp=0;isp<frp.length;isp++){var frsp=frp[isp];if(frsp.length>0){if(ip>p){for(var f=frsp.length-1;f>=0;f--){_hideFragment(ip,isp,f)}}else if(ip<p){for(var f=0;f<frsp.length;f++){_showFragment(ip,isp,f)}}else if(ip==p){if(isp>sp){for(var f=frsp.length-1;f>=0;f--){_hideFragment(ip,isp,f)}}else if(isp<sp){for(var f=0;f<frsp.length;f++){_showFragment(ip,isp,f)}}else if(isp==sp){if(_fragmentsOnBack==true&&(pastIndex.section>NavigationMatrix.getPageIndex().section||pastIndex.page>NavigationMatrix.getPageIndex().page)){for(var f=0;f<frsp.length;f++){_showFragment(ip,isp,f)}}else{for(var f=frsp.length-1;f>=0;f--){_hideFragment(ip,isp,f)}}if(_fragmentsOnBack==false){fr[ip][isp]=-1}else{if(pastIndex.section>NavigationMatrix.getPageIndex().section||pastIndex.page>NavigationMatrix.getPageIndex().page){fr[ip][isp]=frsp.length-1}else{fr[ip][isp]=-1}}}}}}}}function _getSection(h){if(h){}return p}function _getPage(h){if(h){}return sp}function _getSections(){return sections}function _getPages(i){return sectionsArray[i]}function _getAllPages(){return allPages}function _getSectionsLength(){return sectionsLength}function _getPagesLength(){return pagesLength}function _getPagesTotalLength(){return pagesTotalLength}function _getPageIndex(d){var pIndex=p;var spIndex=sp;if(d!=undefined){pIndex=d.parentNode.index;spIndex=d.index}return{section:pIndex,page:spIndex}}function _getSectionByIndex(i){return sections[i]}function _getPageByIndex(i,pi){return sectionsArray[pi][i]}function _getCurrentSection(){return sections[p]}function _getCurrentPage(){return sectionsArray[p][sp]}function _getPrevSectionIndex(){var sectionIndex=p-1;if(sectionIndex<0){if(_isLoopable===true){sectionIndex=sectionsArray.length-1}else{return null}}return sectionIndex}function _getPrevSectionObject(){var sectionIndex=_getPrevSectionIndex();if(sectionIndex===null){return null}return sections[sectionIndex]}function _getPrevPageObject(){var pageIndex=sp-1;if(pageIndex<0){if(p===0&&_isLoopable){var sectionIndex=sectionsArray.length-1;return sectionsArray[sectionIndex][sectionsArray[sectionIndex].length-1]}else if(p>0){return sectionsArray[p-1][sectionsArray[p-1].length-1]}else{return null}}return sectionsArray[p][pageIndex]}function _getNextSectionIndex(){var sectionIndex=p+1;if(sectionIndex>sectionsArray.length-1){if(_isLoopable===true){sectionIndex=0}else{return null}}return sectionIndex}function _getNextSectionObject(){var sectionIndex=_getNextSectionIndex();if(sectionIndex===null){return null}return sections[sectionIndex]}function _getNextPageObject(){var pageIndex=sp+1;if(pageIndex>sectionsArray[p].length-1){if(p===sectionsArray.length-1&&_isLoopable){return sectionsArray[0][0]}else if(p<sectionsArray.length-1){return sectionsArray[p+1][0]}else{return null}}return sectionsArray[p][pageIndex]}function _getCurrentFragment(){return fragmentsArray[p][sp][_getCurrentFragmentIndex()]}function _getCurrentFragmentIndex(){return fr[p][sp]}function _hasNextSection(){return p<sections.length-1}function _hasPrevSection(){return p>0}function _hasNextPage(){return sp<sectionsArray[p].length-1}function _hasPrevPage(){return sp>0}function _getProgress(){if(p==0&&sp==0){return 0}var c=0;for(var i=0;i<p;i++){c+=sectionsArray[i].length}c+=sectionsArray[p][sp].index+1;return c}function _getHash(d){if(d!=undefined){sp=_getPageIndex(d).page;p=_getPageIndex(d).section}var h="";var _p=sections[p];h+=getPageId(_p);if(sectionsArray[p].length>1){var _sp=sectionsArray[p][sp];h+="/"+getPageId(_sp)}return h}function _setPage(h){var elem=getElementByHash(h);if(elem){var pElem=elem.parentNode;for(var i=0;i<sectionsArray.length;i++){var pa=sectionsArray[i];if(sections[i]===pElem){p=i;for(var ii=0;ii<pa.length;ii++){if(pa[ii]===elem){sp=ii;break}}}}_updateFragments()}return elem}function _switchActivePage(d,navigate){var sIndex=d.parentNode.index;for(var i=0;i<sectionsArray.length;i++){var pa=sectionsArray[i];for(var ii=0;ii<pa.length;ii++){var spa=pa[ii];Brav1Toolbox.removeClass(spa,"past-section");Brav1Toolbox.removeClass(spa,"future-section");Brav1Toolbox.removeClass(spa,"past-page");Brav1Toolbox.removeClass(spa,"future-page");if(spa!==d){Brav1Toolbox.removeClass(spa,"hilite");if(isOverview==false&&spa!==_getCurrentPage()){Brav1Toolbox.removeClass(spa,"actual")}if(i<sIndex){Brav1Toolbox.addClass(spa,"past-section")}else if(i>sIndex){Brav1Toolbox.addClass(spa,"future-section")}if(spa.index<d.index){Brav1Toolbox.addClass(spa,"past-page")}else if(spa.index>d.index){Brav1Toolbox.addClass(spa,"future-page")}}}}Brav1Toolbox.addClass(d,"hilite");if(navigate){setActual(d)}hilited=d}function _getCurrentHilited(){return hilited}function setActual(d){Brav1Toolbox.addClass(d,"actual")}_updateMatrix();return{update:_updateMatrix,updateFragments:_updateFragments,showFragments:_showFragments,hideFragments:_hideFragments,getSection:_getSection,getPage:_getPage,getSections:_getSections,getPages:_getPages,getAllPages:_getAllPages,getNextSection:_getNextSection,getPrevSection:_getPrevSection,getNextPage:_getNextPage,getPrevPage:_getPrevPage,getSectionsLength:_getSectionsLength,getPagesLength:_getPagesLength,getPagesTotalLength:_getPagesTotalLength,getPageIndex:_getPageIndex,getSectionByIndex:_getSectionByIndex,getPageByIndex:_getPageByIndex,getCurrentSection:_getCurrentSection,getCurrentPage:_getCurrentPage,getPrevSectionObject:_getPrevSectionObject,getPrevPageObject:_getPrevPageObject,getNextSectionObject:_getNextSectionObject,getNextPageObject:_getNextPageObject,getCurrentFragment:_getCurrentFragment,getCurrentFragmentIndex:_getCurrentFragmentIndex,getProgress:_getProgress,getHash:_getHash,setPage:_setPage,switchActivePage:_switchActivePage,getCurrentHilited:_getCurrentHilited,hasNextSection:_hasNextSection,hasPrevSection:_hasPrevSection,hasNextPage:_hasNextPage,hasPrevPage:_hasPrevPage,updateOffsets:_updateOffsets,getParallaxElements:_getParallaxElements}}();if(browserSupport){if(isTouchDevice){Brav1Toolbox.addListener(document,"touchend",function(e){e.preventDefault();onNavClick(e)},false)}Brav1Toolbox.addListener(document,"click",onNavClick,false)}function onNavClick(e){if(_areLinksActive){if(e.target.nodeName==="A"||e.target.parentNode.nodeName==="A"){var href=e.target.getAttribute("href")||e.target.parentNode.getAttribute("href");if(href==="#"){return}if(href){e.target.blur();if(href.substr(0,1)=="#"){e.preventDefault();var dest=NavigationMatrix.setPage(href);navigateTo(dest,true,true)}}}if(isOverview){var dest=e.target;while(dest&&!Brav1Toolbox.hasClass(dest,PAGE_CLASS)){dest=dest.parentNode}if(Brav1Toolbox.hasClass(dest,PAGE_CLASS)){e.preventDefault();navigateTo(dest,null,true)}}if(Brav1Toolbox.hasClass(e.target,PAGE_THUMB_CLASS)){e.preventDefault();var pTo=Number(unsafeAttr(e.target.getAttribute("data-section")));var spTo=Number(unsafeAttr(e.target.getAttribute("data-page")));_gotoPage(pTo,spTo)}}}if(useHash==false&&window.history.pushState){window.onpopstate=onPopState}else{useHash=true}function onPopState(e){useHash=false;var h;if(e.state){h=e.state.token.replace("#/","")}else{h=document.location.hash.replace("#/","")}var dest=NavigationMatrix.setPage(h);navigateTo(dest,false)}Brav1Toolbox.addListener(window,"hashchange",onHashChange);function onHashChange(e,d){if(useHash||d){var h=document.location.hash.replace("#/","");var dest=NavigationMatrix.setPage(h);navigateTo(dest,false)}}function _setMouseDrag(value){_mouseDragEnabled=value;if(_mouseDragEnabled){Brav1Toolbox.addListener(ftContainer,"mousedown",onTouchStart,false);Brav1Toolbox.addListener(ftContainer,"mouseup",onTouchEnd,false)}else{Brav1Toolbox.removeListener(ftContainer,"mousedown",onTouchStart);Brav1Toolbox.removeListener(ftContainer,"mouseup",onTouchEnd)}}var _ftX=ftContainer.offsetX;var _ftY=0;var _touchStartX=0;var _touchStartY=0;var _deltaX=0;var _deltaY=0;var _dragging=0;var _dragAxis="x";var _swipeLimit=100;if(isTouchDevice){ftContainer.addEventListener("touchstart",onTouchStart,false);ftContainer.addEventListener("touchmove",onTouchMove,false);ftContainer.addEventListener("touchend",onTouchEnd,false)}function onTouchStart(e){_deltaX=0;_deltaY=0;e=getTouchEvent(e);_touchStartX=e.clientX;_touchStartY=e.clientY;_dragging=1;var initOffset=getInitOffset();_ftX=initOffset.x;_ftY=initOffset.y;if(_mouseDragEnabled){Brav1Toolbox.addListener(ftContainer,"mousemove",onTouchMove,false)}}function onTouchMove(e){e.preventDefault();e=getTouchEvent(e);_deltaX=e.clientX-_touchStartX;_deltaY=e.clientY-_touchStartY}function onTouchEnd(e){if(_isTouchActive){if(Math.abs(_deltaX)>=_swipeLimit||Math.abs(_deltaY)>=_swipeLimit){e=getTouchEvent(e);_dragging=0;_dragAxis=Math.abs(_deltaX)>=Math.abs(_deltaY)?"x":"y";if(_dragAxis=="x"&&Math.abs(_deltaX)>=_swipeLimit){if(_deltaX>0){if(_crossDirection===true){_prevPage()}else{_prevSection()}return}else if(_deltaX<0){if(_crossDirection===true){_nextPage()}else{_nextSection()}return}}else{if(_deltaY>0&&Math.abs(_deltaY)>=_swipeLimit){if(_crossDirection===true){_prevSection()}else{_prevPage()}return}else if(_deltaY<0){if(_crossDirection===true){_nextSection()}else{_nextPage()}return}}}}Brav1Toolbox.removeListener(ftContainer,"mousemove",onTouchMove)}function getTouchEvent(e){if(e.touches){e=e.touches[0]}return e}function getInitOffset(){var off=ftContainer.style[Brav1Toolbox.getPrefixed("transform")];var indexX=off.indexOf("translateX(")+11;var offX=off.substring(indexX,off.indexOf(")",indexX));if(offX.indexOf("%")!=-1){offX=offX.replace("%","");offX=parseInt(offX)/100*window.innerWidth}else if(offX.indexOf("px")!=-1){offX=parseInt(offX.replace("px",""))}var indexY=off.indexOf("translateY(")+11;var offY=off.substring(indexY,off.indexOf(")",indexY));if(offY.indexOf("%")!=-1){offY=offY.replace("%","");offY=parseInt(offY)/100*window.innerHeight}else if(offY.indexOf("px")!=-1){offY=parseInt(offY.replace("px",""))}return{x:offX,y:offY}}var scrollEventEnabled=true;Brav1Toolbox.addListener(window,"scroll",onNativeScroll);function onNativeScroll(e){e.preventDefault();resetScroll()}Brav1Toolbox.addListener(ftContainer,"mousewheel",onMouseScroll,false);ftContainer.addEventListener("DOMMouseScroll",onMouseScroll,false);var scrollTimeout=NaN;function onMouseScroll(e){clearTimeout(scrollTimeout);if(_isScrollActive){e.preventDefault();scrollTimeout=setTimeout(function(){doScrollTimeout(e)},_debouncingDelay)}}function doScrollTimeout(e){clearTimeout(scrollTimeout);if(e.wheelDelta){if(e.wheelDeltaX!=undefined){if(e.wheelDeltaX==0){if(e.wheelDeltaY<0){if(_crossDirection===true){_nextSection()}else{_nextPage()}}else if(e.wheelDeltaY>0){if(_crossDirection===true){_prevSection()}else{_prevPage()}}}else if(e.wheelDeltaY==0){if(e.wheelDeltaX<0){if(_crossDirection===true){_nextPage()}else{_nextSection()}}else if(e.wheelDeltaX>0){if(_crossDirection===true){_prevPage()}else{_prevSection()}}}}else{if(e.wheelDelta<0){_nextPage()}else if(e.wheelDelta>0){_prevPage()}}}else if(e.detail){if(e.detail>0){if(e.axis==1){if(_crossDirection===true){_nextPage()}else{_nextSection()}}else{if(_crossDirection===true){_nextSection()}else{_nextPage()}}}else if(e.detail<0){if(e.axis==1){if(_crossDirection===true){_prevPage()}else{_prevSection()}}else{if(_crossDirection===true){_prevSection()}else{_prevPage()}}}}}var resizeMonitor=function _resizeMonitor(){var ticker=NaN;function _enable(){_disable();if(!isOverview){ticker=setTimeout(doResizeHandler,300)}}function _disable(){clearTimeout(ticker)}function doResizeHandler(){NavigationMatrix.updateOffsets();navigateTo()}Brav1Toolbox.addListener(window,"resize",_enable);window.addEventListener("orientationchange",_enable,false);return{enable:_enable,disable:_disable}}();function getElementByHash(h){if(h.length>0){var aHash=h.replace("#/","").split("/");if(aHash.length>0){var p=document.querySelector(SECTION_SELECTOR+"[data-id=__"+aHash[0]+"]")||document.querySelector(SECTION_SELECTOR+"[data-prog=__"+aHash[0]+"]");if(p!=null){var sp=null;if(aHash.length>1){sp=p.querySelector(PAGE_SELECTOR+"[data-id=__"+aHash[1]+"]")||p.querySelector(PAGE_SELECTOR+"[data-prog=__"+aHash[1]+"]")}if(sp==null){sp=p.querySelector(PAGE_SELECTOR)}return sp}}}return}function _updateNavigation(){NavigationMatrix.update();onHashChange(null,true)}function setTitle(h){var t=siteName;var ht=NavigationMatrix.getCurrentPage().getAttribute("data-title");if(ht==null){var hs=h.split("/");for(var i=0;i<hs.length;i++){t+=" | "+hs[i]}}else{if(NavigationMatrix.getCurrentSection().getAttribute("data-title")!=null){t+=" | "+NavigationMatrix.getCurrentSection().getAttribute("data-title")}t+=" | "+ht}document.title=t}function getPageId(d){return d.getAttribute("data-id")!=null?d.getAttribute("data-id").replace(/__/,""):d.getAttribute("data-prog").replace(/__/,"")}function safeAttr(a){if(a.substr(0,2)!="__"){return"__"+a}else{return a}}function unsafeAttr(a){if(a.substr(0,2)=="__"){return a.replace(/__/,"")}else{return a}}function navigateTo(dest,push,linked){push=push==false?push:true;if(!dest){if(NavigationMatrix.getCurrentPage()!=null){dest=NavigationMatrix.getCurrentPage()}else{dest=document.querySelector(PAGE_SELECTOR)}push=true}navigate(dest);moveParallax(dest);if(isOverview){_toggleOverview(false,false)}var h=NavigationMatrix.getHash(dest);if(linked==true){NavigationMatrix.updateFragments()}var pageIndex=NavigationMatrix.getPageIndex(dest);if(pastIndex.section!=pageIndex.section||pastIndex.page!=pageIndex.page){if(pushHistory!=null&&push!=false&&NavigationMatrix.getCurrentFragmentIndex()==-1){var stateObj={token:h};var nextHash="#/"+h;currentHash=nextHash;window.history.pushState(stateObj,null,currentHash)}else{document.location.hash="/"+h}}setTitle(h);fireNavigationEvent();pastIndex=pageIndex;NavigationMatrix.switchActivePage(dest,true);if(_showProgress){updateProgress()}}function fireNavigationEvent(){var pageIndex=NavigationMatrix.getPageIndex();var eventData={section:NavigationMatrix.getCurrentSection(),page:NavigationMatrix.getCurrentPage(),sectionIndex:pageIndex.section,pageIndex:pageIndex.page,pastSectionIndex:pastIndex.section,pastPageIndex:pastIndex.page,prevSection:NavigationMatrix.hasPrevSection(),nextSection:NavigationMatrix.hasNextSection(),prevPage:NavigationMatrix.hasPrevPage(),nextPage:NavigationMatrix.hasNextPage(),fragment:NavigationMatrix.getCurrentFragment(),fragmentIndex:NavigationMatrix.getCurrentFragmentIndex(),isOverview:isOverview,progress:NavigationMatrix.getProgress(),total:NavigationMatrix.getPagesTotalLength(),isLoopable:_isLoopable,clickerMode:_clickerMode,isAutoplay:_isAutoplay};Brav1Toolbox.dispatchEvent(NAVIGATION_EVENT,eventData);if(_navigationCallback!==undefined){_navigationCallback(eventData)}}function navigate(dest){var x;var y;var pageIndex=NavigationMatrix.getPageIndex(dest);if(_slideInPx==true){x=dest.x;y=dest.y}else{if(_crossDirection===true){y=pageIndex.section;x=pageIndex.page}else{x=pageIndex.section;y=pageIndex.page}}if(Brav1Toolbox.testCSS("transform")){if(_slideInPx){ftContainer.style[Brav1Toolbox.getPrefixed("transform")]="translateX("+-x+"px) translateY("+-y+"px)"}else{ftContainer.style[Brav1Toolbox.getPrefixed("transform")]="translateX("+-x*100+"%) translateY("+-y*100+"%)"}}else{if(_slideInPx){ftContainer.style.top=-y+"px";ftContainer.style.left=-x+"px"}else{ftContainer.style.top=-y*100+"%";ftContainer.style.left=-x*100+"%"}}resetScroll()}function moveParallax(dest){if(parallaxEnabled){var pageIndex=NavigationMatrix.getPageIndex(dest);var pxElements=NavigationMatrix.getParallaxElements();for(var i=0;i<pxElements.length;i++){var pxSection=pxElements[i];if(pxSection!=undefined){for(var ii=0;ii<pxSection.length;ii++){var pxPage=pxSection[ii];if(pxPage!=undefined){for(var iii=0;iii<pxPage.length;iii++){var pxElement=pxPage[iii];var pX=0;var pY=0;if(pageIndex.section<i){pX=pxElement.pX}else if(pageIndex.section>i){pX=-pxElement.pX}if(pageIndex.page<ii){pY=pxElement.pY}else if(pageIndex.page>ii){pY=-pxElement.pY}var unit="%";if(_parallaxInPx){unit="px"}if(_crossDirection===true){pxElement.style[Brav1Toolbox.getPrefixed("transform")]="translateX("+pY+unit+") translateY("+pX+unit+")"}else{pxElement.style[Brav1Toolbox.getPrefixed("transform")]="translateX("+pX+unit+") translateY("+pY+unit+")"}}}}}}}}function resetScroll(){window.scrollTo(0,0)}var defaultProgress=null;var progressFill=null;function buildProgressIndicator(){var domFragment=document.createDocumentFragment();defaultProgress=document.createElement("div");defaultProgress.className=DEFAULT_PROGRESS_CLASS+(_crossDirection===true?" ft-cross":"");domFragment.appendChild(defaultProgress);for(var i=0;i<NavigationMatrix.getSectionsLength();i++){var pDiv=document.createElement("div");pDiv.setAttribute("data-section","__"+i);pDiv.className=SECTION_THUMB_CLASS;Brav1Toolbox.addClass(pDiv,"thumb-section-"+i);var spArray=NavigationMatrix.getPages(i);for(var ii=0;ii<spArray.length;ii++){var spDiv=document.createElement("div");spDiv.className=PAGE_THUMB_CLASS;spDiv.setAttribute("data-section","__"+i);spDiv.setAttribute("data-page","__"+ii);Brav1Toolbox.addClass(spDiv,"thumb-page-"+ii);pDiv.appendChild(spDiv)}defaultProgress.appendChild(pDiv)}body.appendChild(defaultProgress)}function hideProgressIndicator(){if(defaultProgress!=null){body.removeChild(defaultProgress);defaultProgress=null}}function updateProgress(){if(defaultProgress!=null){var spts=defaultProgress.querySelectorAll(PAGE_THUMB_SELECTOR);for(var i=0;i<spts.length;i++){var spt=spts[i];var pTo=Number(unsafeAttr(spt.getAttribute("data-section")));var spTo=Number(unsafeAttr(spt.getAttribute("data-page")));if(pTo==NavigationMatrix.getPageIndex().section&&spTo==NavigationMatrix.getPageIndex().page){Brav1Toolbox.addClass(spts[i],"actual")}else{Brav1Toolbox.removeClass(spts[i],"actual")}}}}function _getDefaultProgress(){return defaultProgress}function _toggleOverview(back,navigate){if(isOverview){zoomIn(back,navigate)}else{overviewCachedDest=NavigationMatrix.getCurrentPage();zoomOut()}}function _setShowOverview(v,back,navigate){if(isOverview===v){return}isOverview=!v;_toggleOverview(back,navigate)}function zoomIn(back,navigate){isOverview=false;Brav1Toolbox.removeClass(body,"ft-overview");NavigationMatrix.hideFragments();navigate=navigate===false?false:true;if(navigate==true){if(back==true){navigateTo(overviewCachedDest)}else{navigateTo()}}}function zoomOut(){isOverview=true;Brav1Toolbox.addClass(body,"ft-overview");NavigationMatrix.showFragments();if(_useOverviewVariant==false){overviewZoomTypeA(true)}else{overviewZoomTypeB(true)}fireNavigationEvent()}function overviewZoomTypeA(out){if(out){if(_crossDirection===true){var scaleY=100/NavigationMatrix.getSectionsLength();var scaleX=100/NavigationMatrix.getPagesLength()}else{var scaleX=100/NavigationMatrix.getSectionsLength();var scaleY=100/NavigationMatrix.getPagesLength()}var scale=Math.min(scaleX,scaleY)*.9;var offsetX=(100-NavigationMatrix.getSectionsLength()*scale)/2;var offsetY=(100-NavigationMatrix.getPagesLength()*scale)/2;ftContainer.style[Brav1Toolbox.getPrefixed("transform")]="translate("+offsetX+"%, "+offsetY+"%) scale("+scale/100+", "+scale/100+")"}}function overviewZoomTypeB(out){if(out){var scale=overviewFixedScaleFactor;var pIndex=NavigationMatrix.getPageIndex();if(_crossDirection===true){var offsetY=50-scale*pIndex.section-scale/2;var offsetX=50-scale*pIndex.page-scale/2}else{var offsetX=50-scale*pIndex.section-scale/2;var offsetY=50-scale*pIndex.page-scale/2}ftContainer.style[Brav1Toolbox.getPrefixed("transform")]="translate("+offsetX+"%, "+offsetY+"%) scale("+scale/100+", "+scale/100+")"}}Brav1Toolbox.addListener(window,"keydown",onKeyDown);Brav1Toolbox.addListener(window,"keyup",onKeyUp);function onKeyDown(e){var tag=e.target.tagName;if(tag!="INPUT"&&tag!="TEXTAREA"&&tag!="SELECT"){if(e.keyCode>=37&&e.keyCode<=40){e.preventDefault()}}}function onKeyUp(e){if(_isKeyboardActive){var tag=e.target.tagName;var elem;if(tag!="INPUT"&&tag!="TEXTAREA"&&tag!="SELECT"){e.preventDefault();switch(e.keyCode){case 27:_toggleOverview(true);break;case 33:if(_clickerMode){_prevPage(e.shiftKey)}else{_gotoTop()}break;case 34:if(_clickerMode){_nextPage(e.shiftKey)}else{_gotoBottom()}break;case 35:_gotoEnd();break;case 36:_gotoHome();break;case 37:if(_crossDirection===true){_prevPage(e.shiftKey)}else{_prevSection(e.shiftKey)}break;case 39:if(_crossDirection===true){_nextPage(e.shiftKey)}else{_nextSection(e.shiftKey)}break;case 38:if(_crossDirection===true){_prevSection(e.shiftKey)}else{_prevPage(e.shiftKey)}break;case 40:if(_crossDirection===true){_nextSection(e.shiftKey)}else{_nextPage(e.shiftKey)}break;case 13:{if(isOverview){_gotoPage(NavigationMatrix.getCurrentHilited())}break}default:break}}}}var _isAutoplay=false;var autoplayTimer=0;var autoplayDelay=1e4;var autoplaySkipFragments=false;var autoplayTimerStartedAt=0;var autoplayTimerPausedAt=0;function _autoplay(status,delay,autostart,skipFragments){autoplayDelay=isNaN(parseInt(delay))?autoplayDelay:delay;autoplaySkipFragments=skipFragments===true||false;if(status==true&&autostart!==false){_play()}}function _play(){_isAutoplay=true;clearTimeout(autoplayTimer);autoplayTimerStartedAt=Date.now();autoplayTimer=setTimeout(function(){_nextPage(autoplaySkipFragments);_play()},autoplayDelay-autoplayTimerPausedAt);autoplayTimerPausedAt=0}function _pause(){_isAutoplay=false;autoplayTimerPausedAt=Date.now()-autoplayTimerStartedAt;clearTimeout(autoplayTimer)}function _stop(){_isAutoplay=false;clearTimeout(autoplayTimer);autoplayTimerStartedAt=0;autoplayTimerPausedAt=0}function _start(){if(_showProgress&&defaultProgress==null){buildProgressIndicator()}if(document.location.hash.length>0){Brav1Toolbox.addClass(ftContainer,"no-transition");onHashChange(null,true);Brav1Toolbox.removeClass(ftContainer,"no-transition")}else{if(_start.arguments.length>0){_gotoPage.apply(this,_start.arguments)}else{_gotoPage(0,0);updateProgress()}}}function _nextSection(top){var d=NavigationMatrix.getNextSection(top,_fragmentsOnSide);if(d!=undefined){navigateTo(d)}else{if(isOverview&&_useOverviewVariant){zoomOut()}}}function _prevSection(top){var d=NavigationMatrix.getPrevSection(top,_fragmentsOnSide);if(d!=undefined){navigateTo(d)}else{if(isOverview&&_useOverviewVariant){zoomOut()}}}function _nextPage(jump){var d=NavigationMatrix.getNextPage(jump);if(d!=undefined){navigateTo(d)}else{if(isOverview&&_useOverviewVariant){zoomOut()}}}function _prevPage(jump){var d=NavigationMatrix.getPrevPage(jump);if(d!=undefined){navigateTo(d)}else{if(isOverview&&_useOverviewVariant){zoomOut()}}}function _gotoPage(){var args=_gotoPage.arguments;if(args.length>0){if(args.length==1){if(Brav1Toolbox.typeOf(args[0])==="Object"){var o=args[0];var p=o.section;var sp=o.page;if(p!=null&&p!=undefined){var pd=document.querySelector(SECTION_SELECTOR+"[data-id="+safeAttr(p)+"]");if(sp!=null&&sp!=undefined){var spd=pd.querySelector(PAGE_SELECTOR+"[data-id="+safeAttr(sp)+"]");if(spd!=null){navigateTo(spd);return}}}}else if(args[0].nodeName!=undefined){navigateTo(args[0],null,true)}}if(Brav1Toolbox.typeOf(args[0])==="Number"||args[0]===0){var spd=NavigationMatrix.getPageByIndex(args[1],args[0]);navigateTo(spd);return}}}function _gotoHome(){_gotoPage(0,0)}function _gotoEnd(){var sl=NavigationMatrix.getSectionsLength()-1;_gotoPage(sl,NavigationMatrix.getPages(sl).length-1)}function _gotoTop(){var pageIndex=NavigationMatrix.getPageIndex();_gotoPage(pageIndex.section,0)}function _gotoBottom(){var pageIndex=NavigationMatrix.getPageIndex();_gotoPage(pageIndex.section,NavigationMatrix.getPages(pageIndex.section).length-1)}function _addEventListener(type,handler,useCapture){Brav1Toolbox.addListener(document,type,handler,useCapture)}function _setFragmentsOnSide(v){_fragmentsOnSide=v;_setFragmentsOnBack(v)}function _setFragmentsOnBack(v){_fragmentsOnBack=v}function _setUseHistory(v){pushHistory=v}function _setSlideInPx(v){_slideInPx=v;navigateTo()}function _setSectionsSlideToTop(v){_sectionsSlideToTop=v}function _setGridNavigation(v){_sectionsSlideToTop=!v}function _setUseOverviewVariant(v){_useOverviewVariant=v}function _setTwoStepsSlide(v){_twoStepsSlide=v}function _setShowProgress(v){_showProgress=v;if(_showProgress){if(defaultProgress==null){buildProgressIndicator()}updateProgress()
}else{if(defaultProgress!=null){hideProgressIndicator()}}}function _setDefaultParallaxValues(x,y){defaultParallaxX=x;defaultParallaxY=y==undefined?defaultParallaxX:y;NavigationMatrix.update()}function _setParallaxInPx(v){_parallaxInPx=v}function _getSectionIndex(){return NavigationMatrix.getPageIndex().section}function _getPageIndex(){return NavigationMatrix.getPageIndex().page}function _loop(v){_isLoopable=v}function _clicker(v){_clickerMode=v}function _enableNavigation(links,keyboard,scroll,touch){_areLinksActive=links===false?false:true;_isKeyboardActive=keyboard===false?false:true;_isScrollActive=scroll===false?false:true;_isTouchActive=touch===false?false:true}function _disableNavigation(links,keyboard,scroll,touch){_areLinksActive=links===false?true:false;_isKeyboardActive=keyboard===false?true:false;_isScrollActive=scroll===false?true:false;_isTouchActive=touch===false?true:false}function _setLinksNavigation(v){_areLinksActive=v===false?false:true}function _setKeyboardNavigation(v){_isKeyboardActive=v===false?false:true}function _setScrollNavigation(v){_isScrollActive=v===false?false:true}function _setTouchNavigation(v){_isTouchActive=v===false?false:true}function _setCrossDirection(v){if(_crossDirection!==v){_crossDirection=v===true?true:false;if(!Brav1Toolbox.hasClass(ftContainer,CROSS_DIRECTION_CLASS)&&_crossDirection===true){Brav1Toolbox.addClass(ftContainer,CROSS_DIRECTION_CLASS)}else if(Brav1Toolbox.hasClass(ftContainer,CROSS_DIRECTION_CLASS)&&_crossDirection!==true){Brav1Toolbox.removeClass(ftContainer,CROSS_DIRECTION_CLASS)}if(defaultProgress){if(!Brav1Toolbox.hasClass(defaultProgress,CROSS_DIRECTION_CLASS)&&_crossDirection===true){Brav1Toolbox.addClass(defaultProgress,CROSS_DIRECTION_CLASS)}else if(Brav1Toolbox.hasClass(defaultProgress,CROSS_DIRECTION_CLASS)&&_crossDirection!==true){Brav1Toolbox.removeClass(defaultProgress,CROSS_DIRECTION_CLASS)}}NavigationMatrix.updateOffsets();navigateTo()}}function _setDebouncingDelay(v){_debouncingDelay=v}function _setNavigationCallback(f){_navigationCallback=f}return{start:_start,updateNavigation:_updateNavigation,nextSection:_nextSection,prevSection:_prevSection,next:_nextPage,prev:_prevPage,nextFragment:_nextPage,prevFragment:_prevPage,gotoPage:_gotoPage,gotoHome:_gotoHome,gotoTop:_gotoTop,gotoBottom:_gotoBottom,gotoEnd:_gotoEnd,toggleOverview:_toggleOverview,showOverview:_setShowOverview,fragmentsOnSide:_setFragmentsOnSide,fragmentsOnBack:_setFragmentsOnBack,useHistory:_setUseHistory,slideInPx:_setSlideInPx,sectionsSlideToTop:_setSectionsSlideToTop,gridNavigation:_setGridNavigation,useOverviewVariant:_setUseOverviewVariant,twoStepsSlide:_setTwoStepsSlide,showProgress:_setShowProgress,defaultParallaxValues:_setDefaultParallaxValues,parallaxInPx:_setParallaxInPx,addEventListener:_addEventListener,getDefaultProgress:_getDefaultProgress,getSection:NavigationMatrix.getCurrentSection,getPage:NavigationMatrix.getCurrentPage,getSectionIndex:_getSectionIndex,getPageIndex:_getPageIndex,getPrevSection:NavigationMatrix.getPrevSectionObject,getNextSection:NavigationMatrix.getNextSectionObject,getPrevPage:NavigationMatrix.getPrevPageObject,getNextPage:NavigationMatrix.getNextPageObject,autoplay:_autoplay,play:_play,pause:_pause,stop:_stop,loop:_loop,clicker:_clicker,mouseDragEnabled:_setMouseDrag,enableNavigation:_enableNavigation,disableNavigation:_disableNavigation,setLinksNavigation:_setLinksNavigation,setKeyboardNavigation:_setKeyboardNavigation,setScrollNavigation:_setScrollNavigation,setTouchNavigation:_setTouchNavigation,setCrossDirection:_setCrossDirection,setDebouncingDelay:_setDebouncingDelay,onNavigation:_setNavigationCallback}}();